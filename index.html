<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>graph-env &mdash; graphenv 0.0.9 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Hallway Environment Example" href="examples/hallway.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> graphenv
          </a>
              <div class="version">
                0.0.9
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">graph-env</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hallway Example</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/hallway.html">Hallway Environment Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/hallway.html#The-hallway-problem-as-graphenv-problem">The hallway problem as graphenv problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/hallway.html#HallwayEnv-Demo">HallwayEnv Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/tune.html">Running <code class="docutils literal notranslate"><span class="pre">GraphEnv</span></code> with <code class="docutils literal notranslate"><span class="pre">ray.tune</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TSP Example</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_docs.html">Traveling Salesperson Problem (TSP) Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_docs.html#TSPState">TSPState</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_docs.html#TSPModel">TSPModel</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_docs.html#TSPEnv-Demo">TSPEnv Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_docs.html#Policy-Training">Policy Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_env.html">TSP Environment Rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_env.html#Beam-Search">Beam Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloud/tsp_on_aws.html">Running TSP on AWS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_autosummary/graphenv.html">graphenv</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">graphenv</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>graph-env</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="graph-env">
<h1>graph-env<a class="headerlink" href="#graph-env" title="Permalink to this headline"></a></h1>
<div class="toctree-wrapper compound">
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">graphenv</span></code> Python library is designed to</p>
<ol class="arabic simple">
<li><p>make graph search problems more readily expressible as RL problems via an extension
of the OpenAI gym API while</p></li>
<li><p>enabling their solution via scalable learning algorithms in the popular RLLib
library.</p></li>
</ol>
<p>RLLib provides out-of-the-box support for both parametrically-defined actions and
masking of invalid actions. However, native support for action spaces where the action
_choices_ change for each state is challenging to implement in a computationally
efficient fashion. The <cite>graphenv</cite> library provides utility classes that simplify the
flattening and masking of action observations for choosing from a set of successor
states at every node in a graph search.</p>
<p>The intended audience for the <code class="docutils literal notranslate"><span class="pre">graphenv</span></code> library consist of researchers working on
graph search problems that are amenable to a reinforcement learning formulation,
broadly described as “learning to optimize”.  This includes those working on
classical combinatorial optimization problems such as the Traveling Salesperson
Problem, as well as problems that do not have a clear algebraic expression but where
the environment dynamics can be simulated, for instance, molecular design.</p>
</section>
<section id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline"></a></h1>
<p>Graphenv can be installed with pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">graphenv</span>
</pre></div>
</div>
<p>Graphenv depends on <cite>gym</cite>, <cite>networkx</cite>, <cite>ray[tune,rllib]</cite>, as well as one of either
<cite>tensorflow</cite> or <cite>pytorch</cite>. You can install Graphenv together with the chosen ML
framework using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">graphenv</span><span class="p">[</span><span class="n">tensorflow</span><span class="p">]</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">graphenv</span><span class="p">[</span><span class="n">torch</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="quick-start">
<h1>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline"></a></h1>
<p><cite>graph-env</cite> allows users to create a customized graph search by subclassing the <cite>Vertex</cite>
class. Basic examples are provided in the [<cite>graphenv/examples</cite>](graphenv/examples)
folder. The following code snippet shows how to randomly sample from valid actions for a
random walk down a 1D corridor:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">graphenv.examples.hallway.hallway_state</span> <span class="kn">import</span> <span class="n">HallwayState</span>
<span class="kn">from</span> <span class="nn">graphenv.graph_env</span> <span class="kn">import</span> <span class="n">GraphEnv</span>

<span class="n">state</span> <span class="o">=</span> <span class="n">HallwayState</span><span class="p">(</span><span class="n">corridor_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">GraphEnv</span><span class="p">({</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">state</span><span class="p">,</span> <span class="s2">&quot;max_num_children&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">make_observation</span><span class="p">()</span>
<span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">total_reward</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
   <span class="n">action</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">children</span><span class="p">)))</span>
   <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
   <span class="n">total_reward</span> <span class="o">+=</span> <span class="n">reward</span>
</pre></div>
</div>
</section>
<section id="tutorials">
<h1>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline"></a></h1>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Hallway Example</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/hallway.html">Hallway Environment Example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/hallway.html#The-hallway-problem-as-graph-problem">The hallway problem as graph problem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples/hallway.html#The-hallway-problem-as-graphenv-problem">The hallway problem as graphenv problem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/hallway.html#HallwayState">HallwayState</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/hallway.html#HallwayModel">HallwayModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/hallway.html#GraphEnv">GraphEnv</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples/hallway.html#HallwayEnv-Demo">HallwayEnv Demo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/hallway.html#Env-creation">Env creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/hallway.html#Reset">Reset</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/hallway.html#Step">Step</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/hallway.html#Step-to-the-terminal-vertex">Step to the terminal vertex</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/hallway.html#Saving-and-loading-GraphEnvs">Saving and loading GraphEnvs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples/tune.html">Running <code class="docutils literal notranslate"><span class="pre">GraphEnv</span></code> with <code class="docutils literal notranslate"><span class="pre">ray.tune</span></code></a></li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">TSP Example</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_docs.html">Traveling Salesperson Problem (TSP) Environment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/tsp_docs.html#Problem-statement">Problem statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/tsp_docs.html#graphenv-formulation"><code class="docutils literal notranslate"><span class="pre">graphenv</span></code> formulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_docs.html#TSPState">TSPState</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/tsp_docs.html#__init__"><code class="docutils literal notranslate"><span class="pre">__init__</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/tsp_docs.html#_make_observation"><code class="docutils literal notranslate"><span class="pre">_make_observation</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/tsp_docs.html#reward"><code class="docutils literal notranslate"><span class="pre">reward</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/tsp_docs.html#_get_children"><code class="docutils literal notranslate"><span class="pre">_get_children</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_docs.html#TSPModel">TSPModel</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_docs.html#TSPEnv-Demo">TSPEnv Demo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/tsp_docs.html#Solution-Method:-Random-Tour">Solution Method: Random Tour</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/tsp_docs.html#Solution-Method:-Greedy-Search">Solution Method: Greedy Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/tsp_docs.html#Solution-Method:-networkx-heuristics">Solution Method: networkx heuristics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_docs.html#Policy-Training">Policy Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_env.html">TSP Environment Rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/tsp_env.html#Beam-Search">Beam Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloud/tsp_on_aws.html">Running TSP on AWS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cloud/tsp_on_aws.html#Getting-Started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloud/tsp_on_aws.html#Deploy-Ray-cluster">Deploy Ray cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloud/tsp_on_aws.html#Connecting-to-head-node">Connecting to head node</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloud/tsp_on_aws.html#Running-TSP-example:">Running TSP example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloud/tsp_on_aws.html#Monitor-the-load-through-Ray-dashboard">Monitor the load through Ray dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloud/tsp_on_aws.html#Destroy-Ray-cluster-(free-up-cloud-resources)">Destroy Ray cluster (free up cloud resources)</a></li>
</ul>
</li>
</ul>
</div>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="examples/hallway.html" class="btn btn-neutral float-right" title="Hallway Environment Example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Alliance for Sustainable Energy, LLC.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>